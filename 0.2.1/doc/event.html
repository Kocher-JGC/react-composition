<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge" ></meta>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
<!–[if IE 8]>
<script src="vendor/polyfill/main.js" ></script>
<![endif]–>
<script src="vendor/react/0.14.8/react.js" ></script>
<script src="vendor/react/0.14.8/react-dom.js" ></script>
<style>
/* http://cdn.bootcss.com/highlight.js/9.6.0/styles/atom-one-dark.min.css */
pre { background: rgb(33,37,46); border-radius: 5px; padding: .5em 1em; color:rgb(155,162,178);}
.hljs{display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-keyword,.hljs-formula{color:#c678dd}.hljs-section,.hljs-name,.hljs-selector-tag,.hljs-deletion,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-string,.hljs-regexp,.hljs-addition,.hljs-attribute,.hljs-meta-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-variable,.hljs-template-variable,.hljs-type,.hljs-selector-class,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-number{color:#d19a66}.hljs-symbol,.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:bold}.hljs-link{text-decoration:underline}

.markdown-body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; font-size: 16px; line-height: 1.5; word-wrap: break-word;padding-left:10px;padding-right: 10px;} .markdown-body::before { display: table; content: "" } .markdown-body::after { display: table; clear: both; content: "" } .markdown-body>*:first-child { margin-top: 0 !important } .markdown-body>*:last-child { margin-bottom: 0 !important } .markdown-body a:not([href]) { color: inherit; text-decoration: none } .markdown-body .absent { color: #c00 } .markdown-body .anchor { float: left; padding-right: 4px; margin-left: -20px; line-height: 1 } .markdown-body .anchor:focus { outline: none } .markdown-body p,.markdown-body blockquote,.markdown-body ul,.markdown-body ol,.markdown-body dl,.markdown-body table,.markdown-body pre { margin-top: 16px; margin-bottom: 16px } .markdown-body hr { height: 0.25em; padding: 0; margin: 24px 0; background-color: #e7e7e7; border: 0 } .markdown-body blockquote { padding: 0 1em; color: #777; border-left: 0.25em solid #ddd } .markdown-body blockquote>:first-child { margin-top: 0 } .markdown-body blockquote>:last-child { margin-bottom: 0 } .markdown-body kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: #555; vertical-align: middle; background-color: #fcfcfc; border: solid 1px #ccc; border-bottom-color: #bbb; border-radius: 3px; box-shadow: inset 0 -1px 0 #bbb } .markdown-body .loweralpha { list-style-type: lower-alpha } .markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6 { margin-top: 24px; margin-bottom: 16px; font-weight: 600; line-height: 1.25 } .markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link { color: #000; vertical-align: middle; visibility: hidden } .markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor { text-decoration: none } .markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link { visibility: visible } .markdown-body h1 tt,.markdown-body h1 code,.markdown-body h2 tt,.markdown-body h2 code,.markdown-body h3 tt,.markdown-body h3 code,.markdown-body h4 tt,.markdown-body h4 code,.markdown-body h5 tt,.markdown-body h5 code,.markdown-body h6 tt,.markdown-body h6 code { font-size: inherit } .markdown-body h1 { padding-bottom: 0.3em; font-size: 2em; border-bottom: 1px solid #eee } .markdown-body h2 { padding-bottom: 0.3em; font-size: 1.5em; border-bottom: 1px solid #eee } .markdown-body h3 { font-size: 1.25em } .markdown-body h4 { font-size: 1em } .markdown-body h5 { font-size: 0.875em } .markdown-body h6 { font-size: 0.85em; color: #777 } .markdown-body ul,.markdown-body ol { padding-left: 2em } .markdown-body ul.no-list,.markdown-body ol.no-list { padding: 0; list-style-type: none } .markdown-body ul ul,.markdown-body ul ol,.markdown-body ol ol,.markdown-body ol ul { margin-top: 0; margin-bottom: 0 } .markdown-body li>p { margin-top: 16px } .markdown-body li+li { margin-top: 0.25em } .markdown-body dl { padding: 0 } .markdown-body dl dt { padding: 0; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold } .markdown-body dl dd { padding: 0 16px; margin-bottom: 16px } .markdown-body table { display: block; width: 100%; overflow: auto } .markdown-body table th { font-weight: bold } .markdown-body table th,.markdown-body table td { padding: 6px 13px; border: 1px solid #ddd } .markdown-body table tr { background-color: #fff; border-top: 1px solid #ccc } .markdown-body table tr:nth-child(2n) { background-color: #f8f8f8 } .markdown-body img { max-width: 100%; box-sizing: content-box; background-color: #fff } .markdown-body img[align=right] { padding-left: 20px } .markdown-body img[align=left] { padding-right: 20px } .markdown-body .emoji { max-width: none; vertical-align: text-top; background-color: transparent } .markdown-body span.frame { display: block; overflow: hidden } .markdown-body span.frame>span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0 0; overflow: hidden; border: 1px solid #ddd } .markdown-body span.frame span img { display: block; float: left } .markdown-body span.frame span span { display: block; padding: 5px 0 0; clear: both; color: #333 } .markdown-body span.align-center { display: block; overflow: hidden; clear: both } .markdown-body span.align-center>span { display: block; margin: 13px auto 0; overflow: hidden; text-align: center } .markdown-body span.align-center span img { margin: 0 auto; text-align: center } .markdown-body span.align-right { display: block; overflow: hidden; clear: both } .markdown-body span.align-right>span { display: block; margin: 13px 0 0; overflow: hidden; text-align: right } .markdown-body span.align-right span img { margin: 0; text-align: right } .markdown-body span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden } .markdown-body span.float-left span { margin: 13px 0 0 } .markdown-body span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden } .markdown-body span.float-right>span { display: block; margin: 13px auto 0; overflow: hidden; text-align: right } .markdown-body code,.markdown-body tt { padding: 0; padding-top: 0.2em; padding-bottom: 0.2em; margin: 0; font-size: 85%; background-color: rgba(0,0,0,0.04); border-radius: 3px } .markdown-body code::before,.markdown-body code::after,.markdown-body tt::before,.markdown-body tt::after { letter-spacing: -0.2em; content: "\00a0" } .markdown-body code br,.markdown-body tt br { display: none } .markdown-body del code { text-decoration: inherit } .markdown-body pre { word-wrap: normal } .markdown-body pre>code { padding: 0; margin: 0; font-size: 100%; word-break: normal; white-space: pre; background: transparent; border: 0 } .markdown-body .highlight { margin-bottom: 16px } .markdown-body .highlight pre { margin-bottom: 0; word-break: normal } .markdown-body .highlight pre,.markdown-body pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45;  border-radius: 3px } .markdown-body pre code,.markdown-body pre tt { display: inline; max-width: auto; padding: 0; margin: 0; overflow: visible; line-height: inherit; word-wrap: normal; background-color: transparent; border: 0 } .markdown-body pre code::before,.markdown-body pre code::after,.markdown-body pre tt::before,.markdown-body pre tt::after { content: normal }
html body {
    width:1100px;
    margin-left: auto;
    margin-right: auto;
}
</style>
<title> 事件触发时机</title>
</head>
<body class="markdown-body" >
<h1 id="-">事件触发时机</h1>
<blockquote>
<p>本业用于理解事件触发时机，不需要读懂本页diamante<br>确保你是在线访问本页面 <a href="https://fast-flow.github.io/react-composition/doc/event.html">https://fast-flow.github.io/react-composition/doc/event.html</a> 或 <a href="https://fast-flow.github.io/react-composition/{版本号}/doc/event.html">https://fast-flow.github.io/react-composition/{版本号}/doc/event.html</a></p>
</blockquote>
<p><div class="markrun markrun--html" >
	<div class="markrun-code" >
		
<div class="status" id="onFocus-status" >
    <span class="status-label">onFocus:</span>
    <span class="status-icon"></span>
    <code id="onFocus-statusValue"></code>
</div>
<div class="status" id="onChange-status" >
    <span class="status-label">onChange:</span>
    <span class="status-icon"></span>
    <code id="onChange-statusValue"></code>
</div>
<div class="status" id="onBlur-status" >
    <span class="status-label">onBlur:</span>
    <span class="status-icon"></span>
    <code id="onBlur-statusValue"></code>
</div>
<div class="status" id="onCompositionStart-status" >
    <span class="status-label">onCompositionStart:</span>
    <span class="status-icon"></span>
    <code id="onCompositionStart-statusValue"></code>
</div>
<div class="status" id="onCompositionUpdate-status" >
    <span class="status-label">onCompositionUpdate:</span>
    <span class="status-icon"></span>
    <code id="onCompositionUpdate-statusValue"></code>
</div>
<div class="status" id="onCompositionEnd-status" >
    <span class="status-label">onCompositionEnd:</span>
    <span class="status-icon"></span>
    <code id="onCompositionEnd-statusValue"></code>
</div>
<hr>
<div id="event"></div>
打开控制台查看原生事件触发记录

	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onFocus-status"</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-label"</span>&gt;</span>onFocus:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onFocus-statusValue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onChange-status"</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-label"</span>&gt;</span>onChange:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onChange-statusValue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onBlur-status"</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-label"</span>&gt;</span>onBlur:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onBlur-statusValue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onCompositionStart-status"</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-label"</span>&gt;</span>onCompositionStart:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onCompositionStart-statusValue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onCompositionUpdate-status"</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-label"</span>&gt;</span>onCompositionUpdate:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onCompositionUpdate-statusValue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onCompositionEnd-status"</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-label"</span>&gt;</span>onCompositionEnd:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"onCompositionEnd-statusValue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"event"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
打开控制台查看原生事件触发记录
</code></pre>
	</div>
</div><br><div class="markrun markrun--css" >
	<div class="markrun-code" >
		<style type="text/css" >
html .status--on .status-icon{
    background-color: #2fc72f;
}
.status-label {
    display: inline-block;
    width:200px;
}
.status-icon {
    background-color:#ddd;
    border-radius:50%;
    width:1em;
    height:1em;
    vertical-align: middle;
    display: inline-block;
    overflow:hidden;
}
textarea {
    border:1px solid #999;
    border-radius:3px;
    width:100%;
    box-sizing: border-box;
}
</style>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-selector-tag">html</span> <span class="hljs-selector-class">.status--on</span> <span class="hljs-selector-class">.status-icon</span>{
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2fc72f</span>;
}
<span class="hljs-selector-class">.status-label</span> {
    <span class="hljs-attribute">display</span>: inline-block;
    <span class="hljs-attribute">width</span>:<span class="hljs-number">200px</span>;
}
<span class="hljs-selector-class">.status-icon</span> {
    <span class="hljs-attribute">background-color</span>:<span class="hljs-number">#ddd</span>;
    <span class="hljs-attribute">border-radius</span>:<span class="hljs-number">50%</span>;
    <span class="hljs-attribute">width</span>:<span class="hljs-number">1em</span>;
    <span class="hljs-attribute">height</span>:<span class="hljs-number">1em</span>;
    <span class="hljs-attribute">vertical-align</span>: middle;
    <span class="hljs-attribute">display</span>: inline-block;
    <span class="hljs-attribute">overflow</span>:hidden;
}
<span class="hljs-selector-tag">textarea</span> {
    <span class="hljs-attribute">border</span>:<span class="hljs-number">1px</span> solid <span class="hljs-number">#999</span>;
    <span class="hljs-attribute">border-radius</span>:<span class="hljs-number">3px</span>;
    <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;
    <span class="hljs-attribute">box-sizing</span>: border-box;
}
</code></pre>
	</div>
</div></p>
<div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var _extends = Object.assign || function (target) {
			for (var i = 1; i < arguments.length; i++) {
				var source = arguments[i];for (var key in source) {
					if (Object.prototype.hasOwnProperty.call(source, key)) {
						target[key] = source[key];
					}
				}
			}return target;
		};

		var React = __webpack_require__(1);
		var ReactDOM = __webpack_require__(2);

		var _count = 0;
		window.count = function () {
			++_count;
			return ('00000000' + _count).replace(/.*(\d{3})$/, '$1');
		};
		var logs = [];
		window.updateStatus = function (fnName, value, count) {
			var eStatus = document.getElementById(fnName + '-status');
			var eStatusValue = document.getElementById(fnName + '-statusValue');
			eStatus.setAttribute('class', 'status status--on');
			eStatusValue.innerHTML = count + '|' + value;
			setTimeout(function () {
				eStatus.setAttribute('class', 'status');
			}, 300);
			logs.push({
				'event': fnName,
				'value': value,
				'count': count
			});
			console.log('原生事件触发记录');
			console.table(logs);
		};

		var App = React.createClass({
			displayName: 'App',

			getInitialState: function getInitialState() {
				var value = '123';
				return {
					value: value,
					finalValue: value,
					inComposition: false
				};
			},
			// 简化 redux
			ms: function ms(action) {
				var state = this.state;
				var props = this.props;
				var data = action.data;
				switch (action.type) {
					case 'CHANGE_VALUE':
						if (!state.inComposition) {
							if (data.value.length > props.maxLength) {
								data.value = data.value.slice(0, props.maxLength);
							}
							state.finalValue = data.value;
						}
						state.value = data.value;
						break;
					case 'COMPOSITION_START':
						state.inComposition = true;
						break;
					case 'COMPOSITION_END':
						state.inComposition = false;
						state.finalValue = data.value;
						break;
				}
				this.setState(state);
			},
			render: function render() {
				var self = this;
				var props = {
					onFocus: function onFocus(event) {
						updateStatus('onFocus', event.target.value, count());
					},
					onChange: function onChange(event) {
						updateStatus('onChange', event.target.value, count());
						self.ms({
							type: 'CHANGE_VALUE',
							data: {
								value: event.target.value
							}
						});
					},
					onBlur: function onBlur(event) {
						console.log(self.state.finalValue);
						updateStatus('onBlur', event.target.value, count());
					},
					onCompositionStart: function onCompositionStart(event) {
						self.ms({
							type: 'COMPOSITION_START'
						});
						updateStatus('onCompositionStart', event.target.value, count());
					},
					onCompositionUpdate: function onCompositionUpdate(event) {
						updateStatus('onCompositionUpdate', event.target.value, count());
					},
					onCompositionEnd: function onCompositionEnd(event) {
						self.ms({
							type: 'COMPOSITION_END',
							data: {
								value: event.target.value
							}
						});
						updateStatus('onCompositionEnd', event.target.value, count());
					}
				};
				return React.createElement('div', null, React.createElement('div', null, 'finalValue: ', self.state.finalValue, React.createElement('br', null), 'value: ', self.state.value, React.createElement('br', null), '\u5B57\u6570\uFF1A', self.state.finalValue.length, '/10', React.createElement('br', null), '\u8FD8\u53EF\u4EE5\u8F93\u5165\uFF1A', self.props.maxLength - self.state.finalValue.length, '\u4E2A\u5B57'), React.createElement('hr', null), '\u8BF7\u5728\u8F93\u5165\u6CD5\u6A21\u5F0F\u548C\u975E\u8F93\u5165\u6CD5\u6A21\u5F0F\u4E0B\u8F93\u5165\u6587\u5B57\uFF0C\u4EE5\u7406\u89E3\u4E8B\u4EF6\u89E6\u53D1\u65F6\u673A \uFF08\u4E3A\u4E86\u517C\u5BB9 chrome \u67D0\u4E9B\u7248\u672C\uFF0C\u5728 onCompositionEnd \u65F6\u4F1A\u89E6\u53D1\u4EE3\u7406\u7684 onChange \uFF09', React.createElement('br', null), React.createElement('textarea', _extends({ type: 'text' }, props, { value: self.state.value })));
			}
		});
		ReactDOM.render(React.createElement(App, { maxLength: 10 }), document.getElementById('event'));

		/***/
	},
	/* 1 */
	/***/function (module, exports) {

		module.exports = React;

		/***/
	},
	/* 2 */
	/***/function (module, exports) {

		module.exports = ReactDOM;

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> ReactDOM = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-dom'</span>)

<span class="hljs-keyword">var</span> _count = <span class="hljs-number">0</span>;
<span class="hljs-built_in">window</span>.count = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    ++_count
    <span class="hljs-keyword">return</span> (<span class="hljs-string">'00000000'</span> + _count).replace(<span class="hljs-regexp">/.*(\d{3})$/</span>,<span class="hljs-string">'$1'</span>)
}
<span class="hljs-keyword">var</span> logs = []
<span class="hljs-built_in">window</span>.updateStatus = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">fnName, value, count</span>) </span>{
    <span class="hljs-keyword">var</span> eStatus = <span class="hljs-built_in">document</span>.getElementById(fnName + <span class="hljs-string">'-status'</span>)
    <span class="hljs-keyword">var</span> eStatusValue = <span class="hljs-built_in">document</span>.getElementById(fnName + <span class="hljs-string">'-statusValue'</span>)
    eStatus.setAttribute(<span class="hljs-string">'class'</span>, <span class="hljs-string">'status status--on'</span>)
    eStatusValue.innerHTML = count + <span class="hljs-string">'|'</span> + value
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        eStatus.setAttribute(<span class="hljs-string">'class'</span>, <span class="hljs-string">'status'</span>)
    }, <span class="hljs-number">300</span>)
    logs.push({
        <span class="hljs-string">'event'</span>: fnName,
        <span class="hljs-string">'value'</span>: value,
        <span class="hljs-string">'count'</span>: count
    })
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'原生事件触发记录'</span>)
    <span class="hljs-built_in">console</span>.table(logs)
}

<span class="hljs-keyword">var</span> App = React.createClass({
    <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> value = <span class="hljs-string">'123'</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">value</span>: value,
            <span class="hljs-attr">finalValue</span>: value,
            <span class="hljs-attr">inComposition</span>: <span class="hljs-literal">false</span>
        }
    },
    <span class="hljs-comment">// 简化 redux</span>
    ms: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
        <span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.state
        <span class="hljs-keyword">var</span> props = <span class="hljs-keyword">this</span>.props
        <span class="hljs-keyword">var</span> data = action.data
        <span class="hljs-keyword">switch</span> (action.type) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'CHANGE_VALUE'</span>:
                <span class="hljs-keyword">if</span> (!state.inComposition) {
                    <span class="hljs-keyword">if</span> (data.value.length &gt; props.maxLength) {
                        data.value = data.value.slice(<span class="hljs-number">0</span>, props.maxLength)
                    }
                    state.finalValue = data.value
                }
                state.value = data.value
            <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">'COMPOSITION_START'</span>:
                state.inComposition = <span class="hljs-literal">true</span>
            <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">'COMPOSITION_END'</span>:
                state.inComposition = <span class="hljs-literal">false</span>
                state.finalValue = data.value
            <span class="hljs-keyword">break</span>
        }
        <span class="hljs-keyword">this</span>.setState(state)
    },
    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>
        <span class="hljs-keyword">var</span> props = {
            <span class="hljs-attr">onFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                updateStatus(<span class="hljs-string">'onFocus'</span>, event.target.value, count())
            },
            <span class="hljs-attr">onChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                updateStatus(<span class="hljs-string">'onChange'</span>, event.target.value, count())
                self.ms({
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'CHANGE_VALUE'</span>,
                    <span class="hljs-attr">data</span>: {
                        <span class="hljs-attr">value</span>: event.target.value
                    }
                })
            },
            <span class="hljs-attr">onBlur</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                <span class="hljs-built_in">console</span>.log(self.state.finalValue)
                updateStatus(<span class="hljs-string">'onBlur'</span>, event.target.value, count())
            },
            <span class="hljs-attr">onCompositionStart</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                self.ms({
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'COMPOSITION_START'</span>
                })
                updateStatus(<span class="hljs-string">'onCompositionStart'</span>, event.target.value, count())
            },
            <span class="hljs-attr">onCompositionUpdate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                updateStatus(<span class="hljs-string">'onCompositionUpdate'</span>, event.target.value, count())
            },
            <span class="hljs-attr">onCompositionEnd</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                self.ms({
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'COMPOSITION_END'</span>,
                    <span class="hljs-attr">data</span>: {
                        <span class="hljs-attr">value</span>: event.target.value
                    }
                })
                updateStatus(<span class="hljs-string">'onCompositionEnd'</span>, event.target.value, count())
            }
        }
        <span class="hljs-keyword">return</span> (
            &lt;div&gt;
                &lt;div&gt;
                finalValue: {self.state.finalValue}
                &lt;br /&gt;
                value: {self.state.value}
                &lt;br /&gt;
                字数：{self.state.finalValue.length}/10
                &lt;br /&gt;
                还可以输入：{self.props.maxLength - self.state.finalValue.length}个字
                &lt;/div&gt;
                &lt;hr /&gt;
                请在输入法模式和非输入法模式下输入文字，以理解事件触发时机 （为了兼容 chrome 某些版本，在 onCompositionEnd 时会触发代理的 onChange ）
                &lt;br /&gt;
                &lt;textarea type="text" {...props} value={self.state.value} /&gt;
            &lt;/div&gt;
        )
    }
})
ReactDOM.render(&lt;App maxLength={10} /&gt;, document.getElementById('event'))
</code></pre>
	</div>
</div>
<h2 id="-">项目作者专用测试</h2>
<p><div class="markrun markrun--html" >
	<div class="markrun-code" >
		
<div id="authorDemo"></div>

	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"authorDemo"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
	</div>
</div><br><div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var _extends = Object.assign || function (target) {
			for (var i = 1; i < arguments.length; i++) {
				var source = arguments[i];for (var key in source) {
					if (Object.prototype.hasOwnProperty.call(source, key)) {
						target[key] = source[key];
					}
				}
			}return target;
		};

		var React = __webpack_require__(1);
		var ReactDOM = __webpack_require__(2);
		var reactComposition = __webpack_require__(3);
		var App = React.createClass({
			displayName: 'App',

			getInitialState: function getInitialState() {
				var value = '123';
				return {
					value: value,
					finalValue: value
				};
			},
			render: function render() {
				var self = this;
				return React.createElement('div', null, 'value: ', self.state.value, React.createElement('br', null), 'finalValue: ', self.state.finalValue, React.createElement('br', null), React.createElement('textarea', _extends({}, reactComposition({
					onChange: function onChange(event) {
						console.log(event.reactComposition);
						if (event.reactComposition.composition === false) {
							self.setState({
								finalValue: event.target.value
							});
						}
						self.setState({
							value: event.target.value
						});
					}
					//,
					// onCompositionStart: function (event) {},
					// onCompositionUpdate: function (event) {},
					// onCompositionEnd: function (event) {}
				}), {
					value: self.state.value
				})));
			}
		});
		ReactDOM.render(React.createElement(App, null), document.getElementById('authorDemo'));

		/***/
	},
	/* 1 */
	/***/function (module, exports) {

		module.exports = React;

		/***/
	},
	/* 2 */
	/***/function (module, exports) {

		module.exports = ReactDOM;

		/***/
	},
	/* 3 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		Object.defineProperty(exports, "__esModule", {
			value: true
		});
		exports["default"] = __webpack_require__(4);

		module.exports = __webpack_require__(4);

		/***/
	},
	/* 4 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		Object.defineProperty(exports, "__esModule", {
			value: true
		});

		var _extend2 = __webpack_require__(5);

		var _extend3 = _interopRequireDefault(_extend2);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		var reactComposition = function reactComposition(userSettings) {
			var returnProps = {};
			var defaultSettings = {
				onChange: null
			};
			var settings = (0, _extend3["default"])(true, defaultSettings, userSettings);
			var defaultReactCompositionStatus = function defaultReactCompositionStatus() {
				return {
					composition: false
				};
			};
			var data = {
				get: function get(event) {
					return event.target.__REACT_COMPOSITION_SECRET_DATA || defaultReactCompositionStatus();
				},
				set: function set(event, obj) {
					event.target.__REACT_COMPOSITION_SECRET_DATA = obj;
				},
				extend: function extend(event, obj) {
					event.target.__REACT_COMPOSITION_SECRET_DATA = (0, _extend3["default"])(true, event.target.__REACT_COMPOSITION_SECRET_DATA, obj);
				}
			};
			returnProps.onChange = function (event) {
				event.reactComposition = data.get(event);
				if (settings.onChange) {
					settings.onChange(event);
				}
			};
			returnProps.onCompositionStart = function (event) {
				if (settings.onCompositionStart) {
					settings.onCompositionStart(event);
				}
				data.extend(event, {
					composition: true
				});
			};
			returnProps.onCompositionUpdate = function (event) {
				if (settings.onCompositionUpdate) {
					settings.onCompositionUpdate(event);
				}
			};
			returnProps.onCompositionEnd = function (event) {
				if (settings.onCompositionEnd) {
					settings.onCompositionEnd(event);
				}
				data.extend(event, {
					composition: false
				});
				event.reactComposition = data.get(event);
				settings.onChange(event);
			};
			return returnProps;
		};
		exports["default"] = reactComposition;

		module.exports = reactComposition;

		/***/
	},
	/* 5 */
	/***/function (module, exports) {

		'use strict';

		var hasOwn = Object.prototype.hasOwnProperty;
		var toStr = Object.prototype.toString;

		var isArray = function isArray(arr) {
			if (typeof Array.isArray === 'function') {
				return Array.isArray(arr);
			}

			return toStr.call(arr) === '[object Array]';
		};

		var isPlainObject = function isPlainObject(obj) {
			if (!obj || toStr.call(obj) !== '[object Object]') {
				return false;
			}

			var hasOwnConstructor = hasOwn.call(obj, 'constructor');
			var hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');
			// Not own constructor property must be Object
			if (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {
				return false;
			}

			// Own properties are enumerated firstly, so to speed up,
			// if last one is own, then all properties are own.
			var key;
			for (key in obj) {/**/}

			return typeof key === 'undefined' || hasOwn.call(obj, key);
		};

		module.exports = function extend() {
			var options,
			    name,
			    src,
			    copy,
			    copyIsArray,
			    clone,
			    target = arguments[0],
			    i = 1,
			    length = arguments.length,
			    deep = false;

			// Handle a deep copy situation
			if (typeof target === 'boolean') {
				deep = target;
				target = arguments[1] || {};
				// skip the boolean and the target
				i = 2;
			} else if ((typeof target === 'undefined' ? 'undefined' : _typeof(target)) !== 'object' && typeof target !== 'function' || target == null) {
				target = {};
			}

			for (; i < length; ++i) {
				options = arguments[i];
				// Only deal with non-null/undefined values
				if (options != null) {
					// Extend the base object
					for (name in options) {
						src = target[name];
						copy = options[name];

						// Prevent never-ending loop
						if (target !== copy) {
							// Recurse if we're merging plain objects or arrays
							if (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {
								if (copyIsArray) {
									copyIsArray = false;
									clone = src && isArray(src) ? src : [];
								} else {
									clone = src && isPlainObject(src) ? src : {};
								}

								// Never move original objects, clone them
								target[name] = extend(deep, clone, copy);

								// Don't bring in undefined values
							} else if (typeof copy !== 'undefined') {
								target[name] = copy;
							}
						}
					}
				}
			}

			// Return the modified object
			return target;
		};

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> ReactDOM = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-dom'</span>)
<span class="hljs-keyword">var</span> reactComposition = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-composition'</span>)
<span class="hljs-keyword">var</span> App = React.createClass({
    <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> value = <span class="hljs-string">'123'</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">value</span>: value,
            <span class="hljs-attr">finalValue</span>: value
        }
    },
    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
                value: {self.state.value}
                <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
                finalValue: {self.state.finalValue}
                <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
                    {<span class="hljs-attr">...reactComposition</span>({
                        <span class="hljs-attr">onChange:</span> <span class="hljs-attr">function</span> (<span class="hljs-attr">event</span>) {
                            <span class="hljs-attr">console.log</span>(<span class="hljs-attr">event.reactComposition</span>)
                            <span class="hljs-attr">if</span> (<span class="hljs-attr">event.reactComposition.composition</span> === <span class="hljs-string">false)</span> {
                                <span class="hljs-attr">self.setState</span>({
                                    <span class="hljs-attr">finalValue:</span> <span class="hljs-attr">event.target.value</span>
                                })
                            }
                            <span class="hljs-attr">self.setState</span>({
                                <span class="hljs-attr">value:</span> <span class="hljs-attr">event.target.value</span>
                            })
                        }
                        //,
                        // <span class="hljs-attr">onCompositionStart:</span> <span class="hljs-attr">function</span> (<span class="hljs-attr">event</span>) {},
                        // <span class="hljs-attr">onCompositionUpdate:</span> <span class="hljs-attr">function</span> (<span class="hljs-attr">event</span>) {},
                        // <span class="hljs-attr">onCompositionEnd:</span> <span class="hljs-attr">function</span> (<span class="hljs-attr">event</span>) {}
                    })}
                    <span class="hljs-attr">value</span>=<span class="hljs-string">{self.state.value}</span>
                /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )
    }
})
ReactDOM.render(<span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>, document.getElementById('authorDemo'))
</span></code></pre>
	</div>
</div></p>

</body>
</html>
